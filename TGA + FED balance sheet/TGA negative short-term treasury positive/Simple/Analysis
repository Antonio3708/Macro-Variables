Uploaded just to share the code. 
Referecene sophisticated test for analysis.
